"use strict";(self["webpackChunkopencdms_app"]=self["webpackChunkopencdms_app"]||[]).push([[9165],{9165:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var a=n(3396);function l(e,t,n,l,o,i){const r=(0,a.up)("station-import",!0);return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(r)])}function o(e,t,n,l,o,i){const r=(0,a.up)("v-card-title"),u=(0,a.up)("v-text-field"),s=(0,a.up)("v-btn"),d=(0,a.up)("v-form"),c=(0,a.up)("v-card-text"),f=(0,a.up)("v-card"),m=(0,a.up)("v-container");return(0,a.wg)(),(0,a.j4)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Import station from OSCAR/Surface")])),_:1}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{clearable:"",rules:[e.rules.validWSI],label:"WIGOS Identifier",modelValue:e.wigos_identifier,"onUpdate:modelValue":t[0]||(t[0]=t=>e.wigos_identifier=t)},null,8,["rules","modelValue"]),(0,a.Wm)(s,{onClick:e.search},{default:(0,a.w5)((()=>[(0,a.Uk)("Search")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})}n(7658);var i=n(4870),r=n(870),u=n(165),s=n(1489),d=n(6572),c=n(1888),f=n(3369),m=n(6422),p=n(5206),v=n(2710),h=n(9941),w=n(2483),_=n(3968),b=(0,a.aZ)({name:"import-wmdr-host",components:{VContainer:f.K,VBtn:r.T,VForm:m.O,VTextField:u.hw,VCard:s._,VCardTitle:d.E,VCardText:c.Z},setup(e,{context:t}){const n=(0,w.tv)(),a=(0,i.iH)(""),l=(0,i.iH)({validWSI:e=>/^0-[0-9]{1,5}-[0-9]{0,5}-[0-9a-zA-Z]{1,16}$/.test(e)||"Invalid WSI"}),o=async()=>{var e={inputs:{WIGOS_identifier:a.value},outputs:{status:null}};e=JSON.stringify(e);var t="https://api.opencdms.org/processes/ingestHost/execution",l=await fetch(t,{method:"POST",body:e,headers:{encode:"json"}});if(l.ok){var o=a.value;await(0,h.m)("https://api.opencdms.org/collections/stations/items/"+o+"?f=json",!0).then((e=>(0,v._)(e.features?e.features:[e]))).then((e=>{(0,_.lL)(p.Z).save(e)}));n.push("/station/"+a.value)}else console.log(l)};return{rules:l,search:o,wigos_identifier:a}}}),V=n(89);const W=(0,V.Z)(b,[["render",o]]);var g=W,S={name:"MyView",components:{StationImport:g}};const C=(0,V.Z)(S,[["render",l]]);var k=C},6422:function(e,t,n){n.d(t,{O:function(){return s}});var a=n(3396),l=n(4357),o=n(3185),i=n(4870),r=n(320),u=n(9888);const s=(0,r.ev)()({name:"VForm",props:{...(0,l.vC)()},emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,t){let{slots:n,emit:r}=t;const s=(0,l.Np)(e),d=(0,i.iH)();function c(e){e.preventDefault(),s.reset()}function f(e){const t=e,n=s.validate();t.then=n.then.bind(n),t.catch=n.catch.bind(n),t.finally=n.finally.bind(n),r("submit",t),t.defaultPrevented||n.then((e=>{let{valid:t}=e;t&&d.value?.submit()})),t.preventDefault()}return(0,u.L)((()=>(0,a.Wm)("form",{ref:d,class:"v-form",novalidate:!0,onReset:c,onSubmit:f},[n.default?.(s)]))),(0,o.F)(s,d)}})}}]);
//# sourceMappingURL=9165.5d5ffab8.js.map