{"version":3,"file":"js/7342.27ed3db0.js","mappings":"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","sources":["webpack://opencdms-app/./src/web-components/wis2-subscription.vue","webpack://opencdms-app/../../../src/components/VTextarea/VTextarea.tsx","webpack://opencdms-app/./src/models/MQTTSubscription.js","webpack://opencdms-app/./src/web-components/wis2-subscription.vue?b6c4"],"sourcesContent":["<template>\n  <v-card>\n    <v-card-title>\n      WIS2.0 Catalogue Search\n    </v-card-title>\n    <v-container>\n      <v-row>\n        <v-col :cols=\"6\">\n          <v-form>\n            <v-text-field label=\"min-x\" v-model=\"minx\"/>\n            <v-text-field label=\"min-y\" v-model=\"miny\"/>\n            <v-text-field label=\"max-x\" v-model=\"maxx\"/>\n            <v-text-field label=\"max-y\" v-model=\"maxy\"/>\n            <v-textarea label=\"Keywords (semi-colon (;) delimited)\" v-model=\"keywords\"/>\n            <v-btn @click=\"searchCatalogue\">Search</v-btn>\n          </v-form>\n        </v-col>\n        <v-col :cols=\"6\">\n          <v-card style=\"height: 600pt;\">\n            <v-card-text style=\"height: 100%;\"><base-map @mapLoaded='onMapLoaded' id=\"map\" @click=\"mapEvent\" zoom=\"3\"/></v-card-text>\n          </v-card>\n        </v-col>\n      </v-row>\n    </v-container>\n  </v-card>\n  <v-card>\n    <v-card-title>\n      {{collections.features.length}} results\n    </v-card-title>\n    <v-card v-for=\"collection in collections.features\">\n      <v-card-title>{{collection.properties.title}}</v-card-title>\n      <v-card-subtitle>{{collection.id}}</v-card-subtitle>\n      <v-card-text>\n        <v-container>\n          <v-row style=\"min-height: 100px;\">\n            <v-col :cols=\"12\">\n              {{collection.properties.description}}\n            </v-col>\n          </v-row>\n      </v-container>\n      </v-card-text>\n      <v-card-actions>\n        <v-btn size=\"small\" @click=\"moreInformation(collection)\">More information</v-btn>\n        <v-btn size=\"small\" @click=\"parseLinks(collection)\">Subscribe</v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-card>\n</template>\n\n<script>\nimport { defineComponent, ref, watch } from 'vue';\nimport { VCard, VCardTitle, VCardText, VForm, VTextField, VTextarea, VContainer, VRow, VCol, VBtn, VCardSubtitle, VCardActions } from 'vuetify/lib/components';\nimport { onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted, onErrorCaptured} from 'vue';\nimport { VFor } from 'vuetify/lib/directives';\n\nimport {useRepo} from 'pinia-orm';\n\nimport BaseMap from \"@/web-components/maps/base-map.vue\";\nimport FeatureMap from \"@/web-components/maps/feature-map.vue\";\n\nimport MQTTSubscription from '@/models/MQTTSubscription.js';\n\nexport default defineComponent({\n  name: 'wis2-subscription',\n  props: {\n  },\n  components: {\n    VCard,\n    VCardTitle,\n    VCardText,\n    VForm, VTextField, VTextarea, VBtn,\n    VContainer, VRow, VCol, VFor,\n    BaseMap, FeatureMap, VCardSubtitle, VCardActions\n  },\n  methods: {},\n  setup(props, {emit}) {\n    const map = ref(null);\n\n    const minx = ref(-180);\n    const miny = ref(-90);\n    const maxx = ref(180);\n    const maxy = ref(90);\n    const keywords = ref(null);\n    const collections = ref({features: []});\n\n    const MQTTSubRepo = ref(null);\n    const useMQTTSub = ref(null);\n\n    MQTTSubRepo.value = useRepo(MQTTSubscription);\n\n    const onMapLoaded = async (mapInstance) => {\n        map.value = mapInstance;\n    };\n\n    const mapEvent = (e) =>{\n      var bounds = map.value.getBounds();\n      minx.value = bounds.getWest();\n      miny.value = bounds.getSouth();\n      maxx.value = bounds.getEast();\n      maxy.value = bounds.getNorth();\n    };\n\n    const searchCatalogue = async () => {\n      var bbox = `&bbox=${minx.value},${miny.value},${maxx.value},${maxy.value}`;\n      var query = \"?\";//q=mqtt\";\n      if( ! (keywords.value == null) ){\n        if( keywords.value.endsWith(\";\") ){\n          keywords.value = keywords.value.slice(0, -1);\n        }\n        query = query + \"q=\" + keywords.value.replace(/;/g,\" AND \");\n      }else{\n        console.log(! (keywords.value == null) )\n        console.log(keywords.value)\n      }\n      console.log(query+bbox);\n      const baseurl = \"https://api.weather.gc.ca/collections/wis2-discovery-metadata/items\"\n      const url = `${baseurl}${query}${bbox}`;\n      console.log( url );\n      const response = await fetch(url);\n      const data = await response.json();\n      console.log(data);\n      collections.value = data;\n    }\n\n    const parseLinks = (collection) => {\n      for( const link of collection.links ){\n        if( link.rel == \"data\" && (link.type == \"MQTT\" || link.type == \"mqtt\")){  // use toLower or similar. Not working, and neither is my brain.\n          console.log(\"MQTT found\");\n          console.log( link );\n          console.log(collection)\n          var sub = {\n            id: collection.id,\n            topic: link['wmo:topic'] ? link['wmo:topic'] : link['channel'],\n            bucket: \"wis2subs\",\n            process: \"ingestBUFR\",\n            subscribed: true\n          }\n          useRepo(MQTTSubscription).insert(sub);\n          console.log(useRepo(MQTTSubscription).all());\n        }else{\n          console.log(\"No MQTT\");\n        }\n      }\n    }\n\n\n    const moreInformation = (collection) => {\n      var url_ = \"https://api.weather.gc.ca/collections/wis2-discovery-metadata/items/\"+collection.id;\n      window.open(url_);\n    }\n\n\n    return {mapEvent, onMapLoaded, minx, miny, maxx, maxy, keywords, parseLinks,\n            searchCatalogue, collections, moreInformation};\n\n  }\n\n});\n</script>\n","// Styles\nimport './VTextarea.sass'\nimport '../VTextField/VTextField.sass'\n\n// Components\nimport { filterFieldProps, makeVFieldProps } from '@/components/VField/VField'\nimport { filterInputProps, makeVInputProps, VInput } from '@/components/VInput/VInput'\nimport { VCounter } from '@/components/VCounter'\nimport { VField } from '@/components/VField'\n\n// Directives\nimport Intersect from '@/directives/intersect'\n\n// Composables\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useFocus } from '@/composables/focus'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, nextTick, onBeforeUnmount, onMounted, ref, watch } from 'vue'\nimport { callEvent, clamp, convertToUnit, filterInputAttrs, genericComponent, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { VFieldSlots } from '@/components/VField/VField'\nimport type { VInputSlots } from '@/components/VInput/VInput'\n\nexport const VTextarea = genericComponent<Omit<VInputSlots & VFieldSlots, 'default'>>()({\n  name: 'VTextarea',\n\n  directives: { Intersect },\n\n  inheritAttrs: false,\n\n  props: {\n    autoGrow: Boolean,\n    autofocus: Boolean,\n    counter: [Boolean, Number, String] as PropType<true | number | string>,\n    counterValue: Function as PropType<(value: any) => number>,\n    hint: String,\n    persistentHint: Boolean,\n    prefix: String,\n    placeholder: String,\n    persistentPlaceholder: Boolean,\n    persistentCounter: Boolean,\n    noResize: Boolean,\n    rows: {\n      type: [Number, String],\n      default: 5,\n      validator: (v: any) => !isNaN(parseFloat(v)),\n    },\n    maxRows: {\n      type: [Number, String],\n      validator: (v: any) => !isNaN(parseFloat(v)),\n    },\n    suffix: String,\n\n    ...makeVInputProps(),\n    ...makeVFieldProps(),\n  },\n\n  emits: {\n    'click:control': (e: MouseEvent) => true,\n    'mousedown:control': (e: MouseEvent) => true,\n    'update:focused': (focused: boolean) => true,\n    'update:modelValue': (val: string) => true,\n  },\n\n  setup (props, { attrs, emit, slots }) {\n    const model = useProxiedModel(props, 'modelValue')\n    const { isFocused, focus, blur } = useFocus(props)\n    const counterValue = computed(() => {\n      return typeof props.counterValue === 'function'\n        ? props.counterValue(model.value)\n        : (model.value || '').toString().length\n    })\n    const max = computed(() => {\n      if (attrs.maxlength) return attrs.maxlength as string | number\n\n      if (\n        !props.counter ||\n        (typeof props.counter !== 'number' &&\n        typeof props.counter !== 'string')\n      ) return undefined\n\n      return props.counter\n    })\n\n    function onIntersect (\n      isIntersecting: boolean,\n      entries: IntersectionObserverEntry[]\n    ) {\n      if (!props.autofocus || !isIntersecting) return\n\n      (entries[0].target as HTMLInputElement)?.focus?.()\n    }\n\n    const vInputRef = ref<VInput>()\n    const vFieldRef = ref<VInput>()\n    const controlHeight = ref('')\n    const textareaRef = ref<HTMLInputElement>()\n    const isActive = computed(() => (\n      isFocused.value ||\n      props.persistentPlaceholder\n    ))\n\n    const messages = computed(() => {\n      return props.messages.length\n        ? props.messages\n        : (isActive.value || props.persistentHint) ? props.hint : ''\n    })\n\n    function onFocus () {\n      if (textareaRef.value !== document.activeElement) {\n        textareaRef.value?.focus()\n      }\n\n      if (!isFocused.value) focus()\n    }\n    function onControlClick (e: MouseEvent) {\n      onFocus()\n\n      emit('click:control', e)\n    }\n    function onControlMousedown (e: MouseEvent) {\n      emit('mousedown:control', e)\n    }\n    function onClear (e: MouseEvent) {\n      e.stopPropagation()\n\n      onFocus()\n\n      nextTick(() => {\n        model.value = ''\n\n        callEvent(props['onClick:clear'], e)\n      })\n    }\n    function onInput (e: Event) {\n      model.value = (e.target as HTMLTextAreaElement).value\n    }\n\n    const sizerRef = ref<HTMLTextAreaElement>()\n    function calculateInputHeight () {\n      if (!props.autoGrow) return\n\n      nextTick(() => {\n        if (!sizerRef.value || !vFieldRef.value) return\n\n        const style = getComputedStyle(sizerRef.value)\n        const fieldStyle = getComputedStyle(vFieldRef.value.$el)\n\n        const padding = parseFloat(style.getPropertyValue('--v-field-padding-top')) +\n          parseFloat(style.getPropertyValue('--v-input-padding-top')) +\n          parseFloat(style.getPropertyValue('--v-field-padding-bottom'))\n\n        const height = sizerRef.value.scrollHeight\n        const lineHeight = parseFloat(style.lineHeight)\n        const minHeight = Math.max(\n          parseFloat(props.rows) * lineHeight + padding,\n          parseFloat(fieldStyle.getPropertyValue('--v-input-control-height'))\n        )\n        const maxHeight = parseFloat(props.maxRows!) * lineHeight + padding || Infinity\n\n        controlHeight.value = convertToUnit(clamp(height ?? 0, minHeight, maxHeight))\n      })\n    }\n\n    onMounted(calculateInputHeight)\n    watch(model, calculateInputHeight)\n    watch(() => props.rows, calculateInputHeight)\n    watch(() => props.maxRows, calculateInputHeight)\n    watch(() => props.density, calculateInputHeight)\n\n    let observer: ResizeObserver | undefined\n    watch(sizerRef, val => {\n      if (val) {\n        observer = new ResizeObserver(calculateInputHeight)\n        observer.observe(sizerRef.value!)\n      } else {\n        observer?.disconnect()\n      }\n    })\n    onBeforeUnmount(() => {\n      observer?.disconnect()\n    })\n\n    useRender(() => {\n      const hasCounter = !!(slots.counter || props.counter || props.counterValue)\n      const hasDetails = !!(hasCounter || slots.details)\n      const [rootAttrs, inputAttrs] = filterInputAttrs(attrs)\n      const [{ modelValue: _, ...inputProps }] = filterInputProps(props)\n      const [fieldProps] = filterFieldProps(props)\n\n      return (\n        <VInput\n          ref={ vInputRef }\n          v-model={ model.value }\n          class={[\n            'v-textarea v-text-field',\n            {\n              'v-textarea--prefixed': props.prefix,\n              'v-textarea--suffixed': props.suffix,\n              'v-text-field--prefixed': props.prefix,\n              'v-text-field--suffixed': props.suffix,\n              'v-textarea--auto-grow': props.autoGrow,\n              'v-textarea--no-resize': props.noResize || props.autoGrow,\n              'v-text-field--flush-details': ['plain', 'underlined'].includes(props.variant),\n            },\n          ]}\n          onClick:prepend={ props['onClick:prepend'] }\n          onClick:append={ props['onClick:append'] }\n          { ...rootAttrs }\n          { ...inputProps }\n          focused={ isFocused.value }\n          messages={ messages.value }\n        >\n          {{\n            ...slots,\n            default: ({\n              isDisabled,\n              isDirty,\n              isReadonly,\n              isValid,\n            }) => (\n              <VField\n                ref={ vFieldRef }\n                style={{\n                  '--v-textarea-control-height': controlHeight.value,\n                }}\n                onClick={ onControlClick }\n                onMousedown={ onControlMousedown }\n                onClick:clear={ onClear }\n                onClick:prependInner={ props['onClick:prependInner'] }\n                onClick:appendInner={ props['onClick:appendInner'] }\n                role=\"textbox\"\n                { ...fieldProps }\n                active={ isActive.value || isDirty.value }\n                dirty={ isDirty.value || props.dirty }\n                focused={ isFocused.value }\n                error={ isValid.value === false }\n              >\n                {{\n                  ...slots,\n                  default: ({\n                    props: { class: fieldClass, ...slotProps },\n                  }) => (\n                    <>\n                      { props.prefix && (\n                        <span class=\"v-text-field__prefix\">\n                          { props.prefix }\n                        </span>\n                      ) }\n\n                      <textarea\n                        ref={ textareaRef }\n                        class={ fieldClass }\n                        value={ model.value }\n                        onInput={ onInput }\n                        v-intersect={[{\n                          handler: onIntersect,\n                        }, null, ['once']]}\n                        autofocus={ props.autofocus }\n                        readonly={ isReadonly.value }\n                        disabled={ isDisabled.value }\n                        placeholder={ props.placeholder }\n                        rows={ props.rows }\n                        name={ props.name }\n                        onFocus={ onFocus }\n                        onBlur={ blur }\n                        { ...slotProps }\n                        { ...inputAttrs }\n                      />\n\n                      { props.autoGrow && (\n                        <textarea\n                          class={[\n                            fieldClass,\n                            'v-textarea__sizer',\n                          ]}\n                          v-model={ model.value }\n                          ref={ sizerRef }\n                          readonly\n                          aria-hidden=\"true\"\n                        />\n                      )}\n\n                      { props.suffix && (\n                        <span class=\"v-text-field__suffix\">\n                          { props.suffix }\n                        </span>\n                      ) }\n                    </>\n                  ),\n                }}\n              </VField>\n            ),\n            details: hasDetails ? slotProps => (\n              <>\n                { slots.details?.(slotProps) }\n\n                { hasCounter && (\n                  <>\n                    <span />\n\n                    <VCounter\n                      active={ props.persistentCounter || isFocused.value }\n                      value={ counterValue.value }\n                      max={ max.value }\n                      v-slots:default={ slots.counter }\n                    />\n                  </>\n                ) }\n              </>\n            ) : undefined,\n          }}\n        </VInput>\n      )\n    })\n\n    return forwardRefs({}, vInputRef, vFieldRef, textareaRef)\n  },\n})\n\nexport type VTextarea = InstanceType<typeof VTextarea>\n","import { Model } from 'pinia-orm'\n\nexport default class MQTTSubscription extends Model {\n  static entity = 'mqtt_subscription' ;\n  static fields(){\n    return{\n      id: this.string(''),\n      topic: this.string(''), // topic we are subscribing to\n      bucket: this.string(''), // where to put the data\n      process: this.string(''), // process to use to process the data\n      collection: this.string(''), // which collection to associate with this subscription\n      subscribed: this.boolean(false) // current status of the process\n    }\n  }\n}\n","import { render } from \"./wis2-subscription.vue?vue&type=template&id=42294102\"\nimport script from \"./wis2-subscription.vue?vue&type=script&lang=js\"\nexport * from \"./wis2-subscription.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/runner/work/opencdms-app/opencdms-app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createVNode","_component_v_card","_component_v_card_title","_component_v_container","_component_v_row","_component_v_col","cols","_component_v_form","_component_v_text_field","label","_ctx","_component_v_textarea","_component_v_btn","onClick","style","_component_v_card_text","_component_base_map","onMapLoaded","id","zoom","features","length","_createElementBlock","_Fragment","collection","_createBlock","properties","title","_component_v_card_subtitle","description","_component_v_card_actions","size","VTextarea","genericComponent","name","directives","Intersect","inheritAttrs","props","autoGrow","Boolean","autofocus","counter","Number","String","counterValue","Function","hint","persistentHint","prefix","placeholder","persistentPlaceholder","persistentCounter","noResize","rows","type","default","validator","v","isNaN","parseFloat","maxRows","suffix","makeVInputProps","makeVFieldProps","emits","e","focused","val","setup","attrs","emit","slots","model","useProxiedModel","isFocused","focus","blur","useFocus","computed","value","toString","max","maxlength","onIntersect","isIntersecting","entries","target","vInputRef","ref","vFieldRef","controlHeight","textareaRef","isActive","messages","onFocus","document","activeElement","onControlClick","onControlMousedown","onClear","stopPropagation","nextTick","callEvent","onInput","sizerRef","calculateInputHeight","getComputedStyle","fieldStyle","$el","padding","getPropertyValue","height","scrollHeight","lineHeight","minHeight","Math","maxHeight","Infinity","convertToUnit","clamp","observer","onMounted","watch","density","ResizeObserver","observe","disconnect","onBeforeUnmount","useRender","hasCounter","hasDetails","details","rootAttrs","inputAttrs","filterInputAttrs","modelValue","_","inputProps","filterInputProps","fieldProps","filterFieldProps","includes","variant","_ref2","isDisabled","isDirty","isReadonly","isValid","dirty","_ref3","class","fieldClass","slotProps","handler","once","undefined","forwardRefs","MQTTSubscription","Model","static","this","string","topic","bucket","process","subscribed","boolean","defineComponent","components","VCard","VCardTitle","VCardText","VForm","VTextField","VBtn","VContainer","VRow","VCol","VFor","BaseMap","FeatureMap","VCardSubtitle","VCardActions","methods","map","minx","miny","maxx","maxy","keywords","collections","MQTTSubRepo","useRepo","async","mapInstance","mapEvent","bounds","getBounds","getWest","getSouth","getEast","getNorth","searchCatalogue","bbox","query","endsWith","slice","replace","console","log","baseurl","url","response","fetch","data","json","parseLinks","link","links","rel","sub","insert","all","moreInformation","url_","window","open","__exports__","render"],"sourceRoot":""}